---
title: 变限积分求导的种种
date: 2022-06-05 09:29:33
category: MATH
tags: 微积分
layout: post
---

## 变上限积分求导的理解

假设 $$F(x)$$ 是 $$f(x)$$ 的一个原函数，即 $$F^{\prime}(x) = f(x)$$。那么对 $$f(x)$$ 积分，有：

$$\int f(x) dx = \int F^{\prime}(x) dx= F(x) +C$$

其中 $$C$$ 是常数，可以将其表示为 $$-F(a)$$。如果 $$f(x)$$ 在 $$[a, x]$$ 上连续，我们对其进行积分：

$$\int_{a}^{x} f(t) dt = \int_{a}^{x} F^{\prime}(t) dt= F(x) - F(a) = F(x) + C$$

<!--more-->因此，其中我们称 $$\int_{a}^{x}f(t)dt$$ 为 $$f(x)$$ 的变上限积的定积分，也算是 $$f(x)$$ 的一个原函数。同时我们也可以得到牛顿-莱布尼茨 (Newton-Leibniz) 公式：

$$\int_{a}^{x=b} f(t)dt = F(b) - F(a)$$

以上严谨的推导需要通过积分中值配合导数的定义来进行求证，这里暂时省略一段。对于变上限积分求导有：

$$\frac{d\int_{a}^{x} f(t) dt}{dx} = \frac{d(F(x) - F(a))}{dx} = F^{\prime}(x) = f(x)$$

对于更一般的情况，当上下限是关于 $$x$$ 的可导函数时：

$$\begin{aligned}\frac{d\int_{\phi(x)}^{\psi(x)} f(t)dt}{dx} &= \frac{dF(\psi(x)) - F(\phi(x))}{dx} \\\\
&= F^{\prime}(\psi(x))\psi^{\prime}(x) - F^{\prime}(\phi(x))\phi^{\prime}(x) \\\\
&=f(\psi(x))\psi^{\prime}(x) - f(\phi(x))\phi^{\prime}(x)\end{aligned}$$

因此对变上下限积分求导有下式：

$$\frac{d\int_{\phi(x)}^{\psi(x)} f(t)dt}{dx} =f(\psi(x))\psi^{\prime}(x) - f(\phi(x))\phi^{\prime}(x)$$

## 应用示例展示

介绍完理论知识，这里进行举例进行应用。其中涉及到变上限积分时，换元操作易出现错误以及被积函数包含积分上限变量的情况。

&clubs; 换元易错示例：

* 问题：

  $$\frac{d}{dx}\int_{0}^{x^2}\cos(t^2)dt$$

* 常规解法：

  $$\frac{d}{dx}\int_{0}^{x^2}\cos(t^{2})dt=2x\cdot \cos(x^4)$$

* 学妹的错误解法：
  
  $$\frac{1}{2}\frac{d}{dx}\int_{0}^{x^2}\cos(t^{2})d(t^2)=x\cdot \cos(x^4)$$

* 学妹的问题在于没有进行上限的变换以及积分变量的换元替换，因此容易出现失误（不熟悉时不建议这么做），咱们按步骤来：

  * 先进行积分变量的替换，令 $$a = t^2$$，有 $$da =d(t^2) \rightarrow da = 2tdt \rightarrow \frac{da}{2t} = dt$$

  * 然后进行积分上下限的计算，当 $$t=0$$ 时，$$a=0$$；当 $$t=x^2$$ 时，$$a=x^4$$。带入有：

    $$\begin{aligned}
    &\frac{d}{dx}\int_{0}^{x^4}\cos a\frac{da}{2t} \\\\
    &\because a = t^2 \Rightarrow t = \sqrt{a} \\\\
    &\Rightarrow \frac{d}{dx}\int_{0}^{x^4}\frac{\cos a}{2\sqrt{a}}da \\\\
    &\Rightarrow \frac{\cos(x^4)}{2\sqrt{x^4}}dx^4 = 2x\cdot \cos(x^4)
    \end{aligned}$$


&spades; 被积函数包含积分上限变量示例：

本示例借用一个学长探究 Newton-Leibniz 公式与 Navier-Stokes 方程关系时，示范容易出现变上限积分求导时犯的错误，学长本身的推导没有错，只是觉得可以用来提醒其他同学：

* 问题：

  求变上限积分 $$\int_{a(t)}^{b(t)} f(x, t)dx$$ 的导数

  将 N-S 方程 $$\frac{\partial \rho}{\partial t}+ \frac{\partial (\rho \mu)}{\partial t} = 0$$ 与上式进行联系

* 解答：

  我们将上述式子具象化，使用一维流动假设进行联系，假设下述是一根无限长的水管，在 $$t$$ 时刻有一滴水（橙色部分），其密度与时间和空间的函数为： $$\rho(x, t)$$ ，如下图所示，水滴的边界为 $$a(t)$$ 和 $$b(t)$$ 。经过时间 $$\Delta t$$ ，水滴位置变为  $$a(t+\Delta t)$$ 和 $$b(t+\Delta t)$$ ，密度变为 $$\rho(x, t+\Delta t)$$（蓝色部分）。

  {% fullwidth 'assets/变限积分求导/1.png' "" %}

  在这迅速变化的世界，我们应该找寻不变的真理。这里的真理就是质量守恒定律，水滴不可能跑着跑着质量还减少了吧，搁这儿减肥呢？因此水滴的质量可以由$$m(t)=\int_{a(t)}^{b(t)}\rho(x,t)dx$$ 求得，由质量守恒定律，即质量对时间的导数为 0，有：
  
  $$\frac{dm}{dt} = \frac{d}{dt}\int_{a(t)}^{b(t)}\rho(x,t)dx = 0$$
  
  这里是不是很眼熟了，不就是变上限积分求导吗？桥豆麻袋，被积函数含有上限变量 $$t$$ ，还能使用其之前的方法直接求导吗？我们举个例子试试：

  题目：
  
  $$\frac{d}{dx}\int_{0}^{x^2} xt^{2}dt$$
  
  解法一：直接对变上限积分直接求导
  
  $$\frac{d}{dx}\int_{0}^{x^2} xt^{2}dt=2x\cdot x \cdot x^4 = 2x^6$$
  
  解法二：先积分后求导，因为 $$x$$ 不是积分变量，因此我们可以直接将其提到积分号的外面
  
  $$\begin{aligned}
  \frac{d}{dx}\int_{0}^{x^2} xt^{2}dt&=\frac{d}{dx}x\int_{0}^{x^2} t^{2}dt \\\\
  &=\frac{d}{dx}x\cdot \frac{1}{3}t^3 \Bigg|^{x^2}_{0} = \frac{7x^6}{3}
  \end{aligned}$$
  
  解法三：将 $$x$$ 放到积分号外面，对里面的使用变上限积分求导
  
  $$\begin{aligned}
  \frac{d}{dx}\int_{0}^{x^2} xt^{2}dt&=\frac{d}{dx}x \cdot\int_{0}^{x^2} t^{2}dt \\\\
  &=\int_{0}^{x^2} t^{2}dt + x \cdot 2x \cdot (x^2)^2 = \frac{7x^6}{3}
  \end{aligned}$$
  
  显然解法二和解法三是正确的。圆规正转，由上可知我们不能直接对 $$\rho(x,t)$$ 使用变上限积分求导。可是我们无法直接先积分后求导，也无法将 $$t$$ 分出来。所以只能采取最原始的办法，即使用导数定义的方式来求解了：
  
  $$\frac{dm}{dt} = \lim_{\Delta t\rightarrow 0}\frac{1}{\Delta t}\Bigg(\int_{a(t+\Delta t)}^{b(t+\Delta t)}\rho(x,t+\Delta t)dx-\int_{a(t)}^{b(t)}\rho(x,t)dx\Bigg)$$
  
  我们可以看到上述分母既有积分上下限的变化，也有被积函数的变化。前者是空间的变化，后者是时间的变化。因此我们得把时空分离开来：
  
  $$\begin{aligned}
  \frac{dm}{dt} = \lim_{\Delta t\rightarrow 0}\frac{1}{\Delta t}\Bigg(\int_{b(t)}^{b(t+\Delta t)}\rho(x,t+\Delta t)dx&+\int_{a(t+\Delta t)}^{a(t)}\rho(x,t+\Delta t)dx \\\\ + \int_{a(t)}^{b(t)}\rho(x,t+\Delta t)dx &-\int_{a(t)}^{b(t)}\rho(x,t)dx\Bigg)
  \end{aligned}$$
  
  上式前面两项是左右边界的变化（空间的变化），因为被积函数保持一致。后面两项则是密度场随时间的变化。前两项分别是积分上限和下限变化，因此使用变限积分求导：
  
  $$\begin{aligned}
  \lim_{\Delta t\rightarrow 0}\frac{1}{\Delta t}\int_{b(t)}^{b(t+\Delta t)}\rho(x,t+\Delta t)dx &= \rho(b(t),t)\frac{db(t)}{dt}=\rho(b(t),t)\mu(b(t),t) \\\\
  \lim_{\Delta t\rightarrow 0}\frac{1}{\Delta t}\int_{a(t+\Delta t)}^{a(t)}\rho(x,t+\Delta t)dx &= \rho(a(t),t)\Big(-\frac{da(t)}{dt}\Big)=\rho(b(t),t)\mu(a(t),t) 
  \end{aligned}$$
  
  其中 $$\mu(x,t)$$ 为速度场。使用牛顿-莱布尼兹公式将其合并：
  
  $$\rho(b(t),t)\frac{db(t)}{dt}-\rho(a(t),t)\frac{da(t)}{dt} =\int_{a(t)}^{b(t)}\frac{\partial (\rho(x,t)\mu(x,t))}{\partial x}dx$$
  
  后两项积分上下限一致，可见是对密度函数的求导，易得：
  
  $$\lim_{\Delta t\rightarrow 0}\frac{1}{\Delta t}\Bigg(\int_{a(t)}^{b(t)}\rho(x,t+\Delta t)-\rho(x,t)dx\Bigg)=\int_{a(t)}^{b(t)}\frac{\partial \rho(x,t)}{\partial t}dx$$
  
  将上述两个结果整理得到最后求导结果：
  
  $$\frac{dm}{dt} = \int_{a(t)}^{b(t)}\Bigg(\frac{\partial (\rho(x,t)\mu(x,t))}{\partial x}+\frac{\partial \rho(x,t)}{\partial t} \Bigg)dx = 0$$
  
  对于任意成立的 $$a(t)$$ 和 $$b(t)$$ 位置，有：
  
  $$\frac{\partial \rho(x,t)}{\partial t}+\frac{\partial (\rho(x,t)\mu(x,t))}{\partial x} = 0 $$
  
  这便是一维的流动连续性方程，对于动量、动量矩、能量积分，便可得到完整的 NS 方程。

  🌸🌸🌸 这段故事完结 🌈🌈🌈